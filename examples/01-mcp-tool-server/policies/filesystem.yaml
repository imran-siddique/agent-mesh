policies:
  - id: "filesystem-access-control"
    name: "Filesystem Access Control"
    version: "1.0.0"
    enabled: true
    
    rules:
      - id: "block-sensitive-paths"
        name: "Block Sensitive System Paths"
        action: "block"
        conditions:
          - "tool == 'filesystem_read' or tool == 'filesystem_write'"
          - "params.path starts_with '/etc/passwd'"
          - "params.path starts_with '/etc/shadow'"
          - "params.path starts_with '/.ssh'"
          - "params.path starts_with '/root'"
        message: "Access to sensitive system path blocked"
        severity: "critical"
      
      - id: "allow-data-directory"
        name: "Allow Data Directory Access"
        action: "allow"
        conditions:
          - "tool == 'filesystem_read'"
          - "params.path starts_with '/data/'"
        message: "Data directory access allowed"
        severity: "info"
      
      - id: "allow-tmp-directory"
        name: "Allow Temp Directory Access"
        action: "allow"
        conditions:
          - "tool == 'filesystem_read' or tool == 'filesystem_write'"
          - "params.path starts_with '/tmp/'"
        message: "Temp directory access allowed"
        severity: "info"
      
      - id: "block-write-by-default"
        name: "Block Filesystem Writes by Default"
        action: "block"
        conditions:
          - "tool == 'filesystem_write'"
          - "not (params.path starts_with '/tmp/')"
        message: "Filesystem writes only allowed to /tmp/"
        severity: "high"
      
      - id: "log-all-filesystem-access"
        name: "Audit All Filesystem Access"
        action: "audit"
        conditions:
          - "tool == 'filesystem_read' or tool == 'filesystem_write'"
        message: "Filesystem access logged"
        severity: "info"
