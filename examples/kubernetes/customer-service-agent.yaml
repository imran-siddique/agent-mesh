---
apiVersion: mesh.agentmesh.ai/v1
kind: GovernedAgent
metadata:
  name: customer-service-agent
  namespace: customer-service
  labels:
    app: customer-service
    team: support
spec:
  image: my-company/customer-service-agent:v2.0.0
  sponsor: "support-lead@company.com"
  
  capabilities:
    - "crm:read"
    - "crm:write"
    - "ticketing:read"
    - "ticketing:write"
    - "email:send"
  
  policy: standard
  
  # Higher replica count for customer-facing service
  replicas: 5
  
  resources:
    limits:
      cpu: "500m"
      memory: "512Mi"
    requests:
      cpu: "200m"
      memory: "256Mi"
  
  env:
    - name: CRM_API_URL
      valueFrom:
        configMapKeyRef:
          name: service-config
          key: crm-api-url
    - name: TICKET_SYSTEM_URL
      valueFrom:
        configMapKeyRef:
          name: service-config
          key: ticket-system-url
    - name: MAX_CONCURRENT_CHATS
      value: "10"
  
  trustScore:
    initialScore: 600  # Higher initial score for customer-facing
    minimumScore: 400
  
  observability:
    traces: true
    metrics: true
    logs: true

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: service-config
  namespace: customer-service
data:
  crm-api-url: "https://crm.company.com/api"
  ticket-system-url: "https://tickets.company.com/api"
