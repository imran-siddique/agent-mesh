# AgentMesh MCP Proxy - Standard Policy
# 
# Balanced policy: Block known-dangerous operations, allow most others.
# Good for development and staging environments.

version: "1.0"
mode: enforce

rules:
  # === DANGEROUS OPERATIONS (BLOCKED) ===

  - tool: "run_shell"
    action: deny
    reason: "Shell execution not permitted"

  - tool: "execute_command"
    action: deny
    reason: "Direct command execution not permitted"

  - tool: "eval"
    action: deny
    reason: "Code evaluation not permitted"

  - tool: "spawn_process"
    action: deny
    reason: "Process spawning not permitted"

  # === SENSITIVE FILE PROTECTION ===

  - tool: "read_file"
    action: allow
    conditions:
      - path_not_contains: [".env", ".secret", "id_rsa", ".pem", "credentials"]

  - tool: "write_file"
    action: allow
    conditions:
      - path_not_contains: [".env", ".secret", "id_rsa", ".pem", "/etc/", "/bin/"]

  # === NETWORK (MONITORED) ===

  - tool: "http_request"
    action: allow
    rate_limit:
      requests: 30
      per: minute

  - tool: "web_search"
    action: allow
    rate_limit:
      requests: 10
      per: minute

  # === ALLOW EVERYTHING ELSE ===

  - tool: "*"
    action: allow

# Rate limits
rate_limits:
  global:
    requests: 100
    per: minute
