# AgentMesh MCP Proxy - Strict Policy
# 
# Allowlist-only policy: Only explicitly permitted tools can run.
# Use this for high-security environments.

version: "1.0"
mode: enforce

# Default behavior: deny all tools not explicitly allowed
default_action: deny

rules:
  # === FILE OPERATIONS (Read-only) ===
  
  - tool: "read_file"
    action: allow
    conditions:
      - path_not_contains: [".env", ".secret", "credentials", "password", ".key"]
    reason: "Read-only file access permitted"

  - tool: "list_directory"
    action: allow
    reason: "Directory listing permitted"

  - tool: "search_files"
    action: allow
    reason: "File search permitted"

  - tool: "get_file_info"
    action: allow
    reason: "File metadata access permitted"

  # === BLOCKED OPERATIONS ===

  - tool: "write_file"
    action: deny
    reason: "Write operations not permitted in strict mode"

  - tool: "delete_file"
    action: deny
    reason: "Delete operations not permitted"

  - tool: "run_shell"
    action: deny
    reason: "Shell execution blocked"

  - tool: "execute_command"
    action: deny
    reason: "Command execution blocked"

  - tool: "eval"
    action: deny
    reason: "Code evaluation blocked"

  # === CATCH-ALL ===
  
  - tool: "*"
    action: deny
    reason: "Tool not in allowlist"

# Rate limits (optional)
rate_limits:
  global:
    requests: 50
    per: minute
  per_tool:
    read_file:
      requests: 20
      per: minute
