{
  "annotations": {
    "list": []
  },
  "description": "AgentMesh trust mesh overview â€” active agents, handshakes, policy violations, trust scores, latency, and delegation depth.",
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 1,
  "id": null,
  "links": [],
  "panels": [
    {
      "id": 1,
      "title": "Active Agents",
      "type": "stat",
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "gridPos": { "h": 4, "w": 6, "x": 0, "y": 0 },
      "targets": [
        {
          "expr": "agentmesh_active_agents",
          "legendFormat": "Active Agents"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "red", "value": null },
              { "color": "yellow", "value": 1 },
              { "color": "green", "value": 5 }
            ]
          }
        },
        "overrides": []
      }
    },
    {
      "id": 2,
      "title": "Trust Handshakes / min",
      "type": "timeseries",
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "gridPos": { "h": 8, "w": 12, "x": 6, "y": 0 },
      "targets": [
        {
          "expr": "rate(agentmesh_trust_handshakes_total[1m])",
          "legendFormat": "{{ result }}"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "custom": { "drawStyle": "line", "fillOpacity": 10 }
        },
        "overrides": []
      }
    },
    {
      "id": 3,
      "title": "Policy Violations / min",
      "type": "timeseries",
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "gridPos": { "h": 8, "w": 6, "x": 18, "y": 0 },
      "targets": [
        {
          "expr": "rate(agentmesh_policy_violations_total[1m])",
          "legendFormat": "{{ policy_id }}"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "custom": { "drawStyle": "line", "fillOpacity": 10 }
        },
        "overrides": []
      }
    },
    {
      "id": 4,
      "title": "Trust Score Distribution",
      "type": "histogram",
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 8 },
      "targets": [
        {
          "expr": "agentmesh_trust_score",
          "legendFormat": "{{ agent_did }}"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "custom": { "fillOpacity": 80 }
        },
        "overrides": []
      }
    },
    {
      "id": 5,
      "title": "Top 10 Most Trusted Agents",
      "type": "table",
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 8 },
      "targets": [
        {
          "expr": "topk(10, agentmesh_trust_score)",
          "format": "table",
          "instant": true,
          "legendFormat": ""
        }
      ],
      "transformations": [
        {
          "id": "organize",
          "options": {
            "renameByName": {
              "agent_did": "Agent DID",
              "Value": "Trust Score"
            }
          }
        }
      ],
      "fieldConfig": {
        "defaults": {},
        "overrides": []
      }
    },
    {
      "id": 6,
      "title": "Handshake Latency p50 / p95 / p99",
      "type": "timeseries",
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 16 },
      "targets": [
        {
          "expr": "histogram_quantile(0.50, rate(agentmesh_handshake_latency_seconds_bucket[5m]))",
          "legendFormat": "p50"
        },
        {
          "expr": "histogram_quantile(0.95, rate(agentmesh_handshake_latency_seconds_bucket[5m]))",
          "legendFormat": "p95"
        },
        {
          "expr": "histogram_quantile(0.99, rate(agentmesh_handshake_latency_seconds_bucket[5m]))",
          "legendFormat": "p99"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "s",
          "custom": { "drawStyle": "line", "fillOpacity": 10 }
        },
        "overrides": []
      }
    },
    {
      "id": 7,
      "title": "Delegation Chain Depth",
      "type": "histogram",
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 16 },
      "targets": [
        {
          "expr": "rate(agentmesh_delegation_depth_bucket[5m])",
          "legendFormat": "{{ le }}"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "custom": { "fillOpacity": 80 }
        },
        "overrides": []
      }
    }
  ],
  "schemaVersion": 39,
  "tags": ["agentmesh", "trust", "observability"],
  "templating": {
    "list": [
      {
        "name": "DS_PROMETHEUS",
        "type": "datasource",
        "query": "prometheus"
      }
    ]
  },
  "time": { "from": "now-1h", "to": "now" },
  "timepicker": {},
  "timezone": "browser",
  "title": "AgentMesh Overview",
  "uid": "agentmesh-overview",
  "version": 1
}
